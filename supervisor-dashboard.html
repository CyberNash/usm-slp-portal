<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supervisor Dashboard - USM SLP</title>
    <script src="js/config.js"></script>
    <link rel="stylesheet" href="css/Dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
</head>
<body>
    <header class="navbar">
        <div class="container">
            <a href="index.html" class="navbar-brand">
                <img src="assets/graduation.png" class="navbar-logo">
                <span>USM Speech Pathology</span>
            </a>
            <nav class="navbar-links">
                <span id="welcome-message"></span>
                <button id="logout-btn" class="nav-button">Logout <i class="fas fa-sign-out-alt"></i></button>
            </nav>
        </div>
    </header>

    <main class="container-fluid" style="padding-top:30px;">
        <!-- REVERTED to a two-column layout -->
        <div class="dashboard-layout">
            <!-- Main Content Area (Now stacks the three cards) -->
            <div class="dashboard-main">
                    <div class="info-box-row">
        <!-- Box 1: Pending Absence Requests -->
                        <div class="small-box bg-warning"> <!-- yellow for pending -->
                        <div class="inner">
                            <h3 id="pending-requests-count">0</h3>
                            <p>Pending Absence Approval</p>
                        </div>
                        <div class="icon"><i class="fas fa-inbox"></i></div>
                        <!-- You can link this to a detailed page later if you want -->
                        <a href="#pending-requests-card" class="small-box-footer">View below <i class="fas fa-arrow-circle-right"></i></a>
                        </div>

                        <!-- Box 2: Link to Attendance Page -->
                        <div class="small-box bg-info"> <!-- blue for attendance -->
                        <div class="inner">
                            <h3>Attendance</h3>
                            <p>Generate Passcodes</p>
                        </div>
                        <div class="icon"><i class="fas fa-user-check"></i></div>
                        <a href="supervisor-attendance.html" class="small-box-footer">Go to page <i class="fas fa-arrow-circle-right"></i></a>
                        </div>

                        <!-- Box 3: Link to Announcements Page -->
                        <div class="small-box bg-success"> <!-- green for announcements -->
                        <div class="inner">
                            <h3>Announcements</h3>
                            <p>Manage Posts</p>
                        </div>
                        <div class="icon"><i class="fas fa-bullhorn"></i></div>
                        <a href="supervisor-announcement.html" class="small-box-footer">Go to page <i class="fas fa-arrow-circle-right"></i></a>
                        </div>
                    </div>
                <!-- Card 1: Pending Absence Requests -->
                <div class="card">
                    <div class="card-header"><i class="fas fa-inbox"></i> Pending Absence Requests</div>
                    <div class="card-content" id="pending-requests-list"></div>
                </div>
                <!-- Card 3: Absence History -->
                <div class="card">
                    <div class="card-header"><i class="fas fa-history"></i> Absence Request History</div>
                    <div class="card-content">
                        <table class="history-table">
                            <tr><th>Student</th><th>Date</th><th>Status</th><th>Reason</th><th>My Notes</th><th>Edit</th></tr>
                            <tbody id="history-table-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Sidebar (Now holds the single, vertical profile card) -->
            <aside class="dashboard-sidebar">
                <div id="supervisor-profile-card" class="card">
                    <!-- The new vertical profile will be loaded here -->
                </div>
            </aside>
        </div>
    </main>
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 USM School of Health Sciences. All Rights Reserved.</p>
            <div class="footer-socials">
                <a href="https://www.instagram.com/usm.official/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="https://www.facebook.com/USMOfficial/" target="_blank" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="mailto:example@usm.my" title="Email"><i class="fas fa-envelope"></i></a>
            </div>
        </div>
    </footer>
    <!-- ======================= MODALS (NEW) ======================= -->
    <div id="modal-backdrop" class="modal-backdrop" style="display: none;">
        <!-- Absence Request Response Modal -->
        <div id="response-modal" class="modal-content" style="display: none;">
            <span class="close-btn">&times;</span>
            <h2 id="response-modal-header" class="modal-header">Edit Request</h2>
            <form id="response-form">
                <!-- Hidden fields to store the context -->
                <input type="hidden" id="response-request-id">
                <input type="hidden" id="response-new-status"> <!-- We will keep this for the 'pending' flow -->

                <!-- === NEW: Status Dropdown for Editing === -->
                <div class="form-group" id="status-edit-group">
                    <label for="response-status">Change Status</label>
                    <select id="response-status">
                        <option value="Approved">Approved</option>
                        <option value="Rejected">Rejected</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="response-notes">Notes for Student</label>
                    <textarea id="response-notes" rows="4" placeholder="e.g., Please provide a medical certificate."></textarea>
                </div>
                
                <button type="submit" id="response-confirm-btn" class="btn-gold">Save Changes</button>
                <button type="button" class="btn-secondary" id="response-cancel-btn">Cancel</button>
            </form>
        </div>
    </div>

    <script src="js/supervisor-dashboard.js"></script>
</body>
</html>